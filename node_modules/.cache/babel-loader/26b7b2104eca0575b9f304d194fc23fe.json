{"ast":null,"code":"import _defineProperty from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Modal,ModalHeader,ModalBody,Nav,NavItem,NavLink,FormGroup,Input,Col,ButtonDropdown,Table,DropdownToggle,DropdownMenu,DropdownItem,Badge,Button,ButtonGroup,Row}from'reactstrap';import APIConstant from'../../../../utils/constants';import{CommonConfig}from'../../../../utils/constants';import'primereact/resources/themes/nova-light/theme.css';import'primereact/resources/primereact.min.css';import'primeicons/primeicons.css';import{Button as BTN}from'primereact/button';import{InputText}from'primereact/inputtext';import api from'../../../../utils/apiClient';import{DataTable}from'primereact/datatable';import{Column}from'primereact/column';import moment from'moment';import{toast}from'react-toastify';var simpleParser=require('mailparser').simpleParser;var _=require('lodash');var Sent=/*#__PURE__*/function(_Component){_inherits(Sent,_Component);var _super=_createSuper(Sent);function Sent(props){var _ref,_ref2;var _this;_classCallCheck(this,Sent);_this=_super.call(this,props);var columns=[{body:_this.actionTemplate.bind(_assertThisInitialized(_this)),style:{width:'50px'},header:\"Action\",sortable:false,filter:false,filterMatchMode:'contains',id:0},(_ref={body:_this.formatNameEmail.bind(_assertThisInitialized(_this)),field:\"FromEmail\",header:\"From\",sortable:true,filter:true},_defineProperty(_ref,\"filter\",false),_defineProperty(_ref,\"filterMatchMode\",'contains'),_defineProperty(_ref,\"id\",3),_ref),(_ref2={body:_this.formatSubject.bind(_assertThisInitialized(_this)),field:\"Subject\",header:\"Subject\",sortable:true,filter:true},_defineProperty(_ref2,\"filter\",false),_defineProperty(_ref2,\"filterMatchMode\",'contains'),_defineProperty(_ref2,\"id\",5),_ref2),{body:_this.formatDate.bind(_assertThisInitialized(_this)),field:\"CreatedOn\",header:\"Date/Time\",sortable:true,filter:false,filterMatchMode:'contains',id:6}];_this.toggle=_this.toggle.bind(_assertThisInitialized(_this));_this.state={editEmailData:'',dropdownOpen:false,emailList:[],InboxCount:0,globalFilter:null,cols:columns,first:1,selectedEmail:[],rows:10,rowsPerPageOptions:CommonConfig.dataTableConfig.rowsPerPageOptions,rowsPerPage:CommonConfig.dataTableConfig.rowsPerPage};_this.getInbox();return _this;}_createClass(Sent,[{key:\"actionTemplate\",value:function actionTemplate(rowData,column){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",{className:\"policy-list-data\"},/*#__PURE__*/React.createElement(BTN,{type:\"button\",icon:\"pi pi-eye\",className:\"p-button-warning\",onClick:function onClick(){return _this2.openDetail(rowData);},style:{marginRight:'.5em'},tooltip:\"View\",tooltipOptions:{position:'bottom'}}));}},{key:\"onPage\",value:function onPage(event){var firstPage=event.first+1;var l=event.rows*(event.page+1);var lastPage=l<this.state.emailList.length?l:this.state.emailList.length;var str=firstPage+' to '+lastPage+' out of '+this.state.emailList.length+' records';this.setState({selectedPage:event.first,str:str,rowsPerPage:event.rows});}},{key:\"formatDate\",value:function formatDate(rowData){return/*#__PURE__*/React.createElement(\"div\",{className:\"policy-list-data\"},/*#__PURE__*/React.createElement(\"p\",null,moment(rowData.CreatedOn).format(CommonConfig.dateFormat.dbDateTime)));}},{key:\"formatSubject\",value:function formatSubject(rowData){return/*#__PURE__*/React.createElement(\"div\",{className:\"policy-list-data\"},/*#__PURE__*/React.createElement(\"p\",null,rowData.Subject,\" \",rowData.AttachCount>0?/*#__PURE__*/React.createElement(\"i\",{class:\"fa fa-paperclip\",\"aria-hidden\":\"true\"},\"(\",rowData.AttachCount,\")\"):null));}},{key:\"formatNameEmail\",value:function formatNameEmail(rowData){return/*#__PURE__*/React.createElement(\"div\",{className:\"policy-list-data\"},/*#__PURE__*/React.createElement(\"p\",null,rowData.FromName),/*#__PURE__*/React.createElement(\"p\",null,rowData.FromEmail));}},{key:\"getInbox\",value:function getInbox(){var _this3=this;var data={\"boxName\":\"Sent\",\"searchType\":\"ALL\",\"PolicyId\":this.state.PolicyId};api.post(APIConstant.path.allEmail,data).then(function(res){console.log(res);if(res.success){_this3.setState({emailList:res.data,selectedEmail:[]});var count=_this3.state.emailList.filter(function(item){if(item.IsViewed.data[0]==0){return true;}else{return false;}}).length;_this3.setState({InboxCount:count});}}).catch(function(err){console.log(err);});}},{key:\"toggle\",value:function toggle(){this.setState({dropdownOpen:!this.state.dropdownOpen});}},{key:\"openDetail\",value:function openDetail(item){this.props.history.push({pathname:'/apps/email/message',state:{type:\"sent\",email:item,InboxCount:this.state.InboxCount}});}},{key:\"rowClass\",value:function rowClass(data){return{'row-accessories':data.IsViewed.data[0]===0};}},{key:\"render\",value:function render(){var _this4=this;var columns=this.state.cols.map(function(col,i){return/*#__PURE__*/React.createElement(Column,{key:i,field:col.field,header:col.header,body:col.body,sortable:col.sortable,filter:col.filter,filterMatchMode:col.filterMatchMode});});return/*#__PURE__*/React.createElement(\"div\",{className:\"animated fadeIn\"},/*#__PURE__*/React.createElement(\"div\",{className:\"email-app mb-4\"},/*#__PURE__*/React.createElement(\"nav\",null,/*#__PURE__*/React.createElement(\"a\",{href:\"#/apps/email/compose\",className:\"btn btn-danger btn-block\"},\"New Email\"),/*#__PURE__*/React.createElement(Nav,null,/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{href:\"#/apps/email/inbox\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-inbox\"}),\" Inbox \",/*#__PURE__*/React.createElement(Badge,{color:\"danger\"},this.state.InboxCount))),/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{href:\"#/apps/email/sent\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-inbox\"}),\" Sent \")))),/*#__PURE__*/React.createElement(\"main\",{className:\"inbox\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"messages\"},/*#__PURE__*/React.createElement(DataTable,{ref:function ref(el){return _this4.dt=el;},value:this.state.emailList,rowClassName:this.rowClass,first:this.state.selectedPage,onPage:function onPage(e){return _this4.onPage(e);},paginator:true,rows:this.state.rowsPerPage,totalRecords:this.state.emailList.length,exportFilename:\"Email List\",currentPageReportTemplate:this.state.str,paginatorTemplate:\"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown\",rowsPerPageOptions:this.state.rowsPerPageOptions,globalFilter:this.state.globalFilter,emptyMessage:\"No records found\",responsive:true,resizableColumns:true,columnResizeMode:\"fit\",scrollable:true,scrollHeight:\"340px\"},columns)))));}}]);return Sent;}(Component);export default Sent;","map":{"version":3,"sources":["/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/src/views/Apps/Email/Sent/Sent.js"],"names":["React","Component","Modal","ModalHeader","ModalBody","Nav","NavItem","NavLink","FormGroup","Input","Col","ButtonDropdown","Table","DropdownToggle","DropdownMenu","DropdownItem","Badge","Button","ButtonGroup","Row","APIConstant","CommonConfig","BTN","InputText","api","DataTable","Column","moment","toast","simpleParser","require","_","Sent","props","columns","body","actionTemplate","bind","style","width","header","sortable","filter","filterMatchMode","id","formatNameEmail","field","formatSubject","formatDate","toggle","state","editEmailData","dropdownOpen","emailList","InboxCount","globalFilter","cols","first","selectedEmail","rows","rowsPerPageOptions","dataTableConfig","rowsPerPage","getInbox","rowData","column","openDetail","marginRight","position","event","firstPage","l","page","lastPage","length","str","setState","selectedPage","CreatedOn","format","dateFormat","dbDateTime","Subject","AttachCount","FromName","FromEmail","data","PolicyId","post","path","allEmail","then","res","console","log","success","count","item","IsViewed","catch","err","history","push","pathname","type","email","map","col","i","el","dt","rowClass","e","onPage"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Modal, ModalHeader, ModalBody, Nav, NavItem, NavLink, FormGroup, Input, Col, ButtonDropdown, Table, DropdownToggle, DropdownMenu, DropdownItem, Badge, Button, ButtonGroup, Row } from 'reactstrap';\nimport APIConstant from '../../../../utils/constants';\nimport { CommonConfig } from '../../../../utils/constants';\nimport 'primereact/resources/themes/nova-light/theme.css';\nimport 'primereact/resources/primereact.min.css';\nimport 'primeicons/primeicons.css';\nimport { Button as BTN } from 'primereact/button';\nimport { InputText } from 'primereact/inputtext';\nimport api from '../../../../utils/apiClient';\nimport { DataTable } from 'primereact/datatable';\nimport { Column } from 'primereact/column';\nimport moment from 'moment';\nimport { any } from 'prop-types';\nimport { toast } from 'react-toastify';\nconst simpleParser = require('mailparser').simpleParser;\nconst _ = require('lodash');\n\nclass Sent extends Component {\n\n  constructor(props) {\n    super(props);\n\n    let columns = [\n      { body: this.actionTemplate.bind(this), style: { width: '50px' }, header: \"Action\", sortable: false, filter: false, filterMatchMode: 'contains', id: 0 },\n      { body: this.formatNameEmail.bind(this), field: \"FromEmail\", header: \"From\", sortable: true, filter: true, filter: false, filterMatchMode: 'contains', id: 3 },\n      { body: this.formatSubject.bind(this), field: \"Subject\", header: \"Subject\", sortable: true, filter: true, filter: false, filterMatchMode: 'contains', id: 5 },\n      { body: this.formatDate.bind(this), field: \"CreatedOn\", header: \"Date/Time\", sortable: true, filter: false, filterMatchMode: 'contains', id: 6 },\n    ];\n\n    this.toggle = this.toggle.bind(this);\n    this.state = {\n      editEmailData: '',\n      dropdownOpen: false,\n      emailList: [],\n      InboxCount: 0,\n      globalFilter: null,\n      cols: columns,\n      first: 1,\n      selectedEmail: [],\n      rows: 10,\n      rowsPerPageOptions: CommonConfig.dataTableConfig.rowsPerPageOptions,\n      rowsPerPage: CommonConfig.dataTableConfig.rowsPerPage,\n    };\n    \n    this.getInbox()\n  }\n\n  actionTemplate(rowData, column) {\n    return <div className=\"policy-list-data\">\n      <BTN type=\"button\" icon=\"pi pi-eye\" className=\"p-button-warning\" onClick={() => this.openDetail(rowData)}\n        style={{ marginRight: '.5em' }} tooltip=\"View\" tooltipOptions={{ position: 'bottom' }}>\n      </BTN>\n    </div>;\n  }\n\n  onPage(event) {\n    let firstPage = event.first + 1;\n    let l = event.rows * (event.page + 1);\n    let lastPage = (l < this.state.emailList.length) ? l : this.state.emailList.length\n    var str = firstPage + ' to ' + lastPage + ' out of ' + this.state.emailList.length + ' records';\n    this.setState({ selectedPage: event.first, str: str, rowsPerPage: event.rows });\n  }\n\n  formatDate(rowData) {\n    return (\n      <div className=\"policy-list-data\">\n        <p>{moment(rowData.CreatedOn).format(CommonConfig.dateFormat.dbDateTime)}</p>\n      </div>\n    )\n  }\n\n  formatSubject(rowData) {\n    return (\n      <div className=\"policy-list-data\">\n        <p>{rowData.Subject} {rowData.AttachCount > 0 ? <i class=\"fa fa-paperclip\" aria-hidden=\"true\">({rowData.AttachCount})</i> : (null)}</p>\n      </div>\n    )\n  }\n\n  formatNameEmail(rowData) {\n    return (\n      <div className=\"policy-list-data\">\n        <p>{rowData.FromName}</p>\n        <p>{rowData.FromEmail}</p>\n      </div>\n    )\n  }\n\n  getInbox() {\n    let data = {\n      \"boxName\": \"Sent\",\n      \"searchType\": \"ALL\",\n      \"PolicyId\":this.state.PolicyId\n    }\n    api.post(APIConstant.path.allEmail, data).then(res => {\n      console.log(res)\n      if (res.success) {\n        this.setState({ emailList: res.data ,selectedEmail:[]});\n        let count = this.state.emailList.filter((item) => {\n          if (item.IsViewed.data[0] == 0) {\n            return true\n          } else {\n            return false\n          }\n        }).length\n        this.setState({ InboxCount: count })\n      }\n    }).catch(err => {\n      console.log(err)\n    });\n  }\n\n  toggle() {\n    this.setState({\n      dropdownOpen: !this.state.dropdownOpen\n    });\n  }\n\n  openDetail(item) {\n    this.props.history.push({\n      pathname: '/apps/email/message',\n      state: {\n        type:\"sent\",\n        email: item,\n        InboxCount: this.state.InboxCount\n      }\n    });\n  }\n\n  rowClass(data) {\n    return {\n      'row-accessories': data.IsViewed.data[0] === 0\n    }\n  }\n\n  render() {\n\n    let columns = this.state.cols.map((col, i) => {\n      return <Column key={i} field={col.field} header={col.header} body={col.body} sortable={col.sortable} filter={col.filter} filterMatchMode={col.filterMatchMode} />;\n    });\n\n    return (\n      <div className=\"animated fadeIn\">\n        <div className=\"email-app mb-4\">\n          <nav>\n            <a href=\"#/apps/email/compose\" className=\"btn btn-danger btn-block\">New Email</a>\n            <Nav>\n              <NavItem>\n                <NavLink href=\"#/apps/email/inbox\"><i className=\"fa fa-inbox\"></i> Inbox <Badge color=\"danger\">{this.state.InboxCount}</Badge></NavLink>\n              </NavItem>\n              <NavItem>\n                <NavLink href=\"#/apps/email/sent\"><i className=\"fa fa-inbox\"></i> Sent </NavLink>\n              </NavItem>\n            </Nav>\n          </nav>\n          <main className=\"inbox\">\n            <ul className=\"messages\">\n              <DataTable\n                ref={(el) => this.dt = el}\n                value={this.state.emailList}\n                rowClassName={this.rowClass}\n                first={this.state.selectedPage}\n                onPage={(e) => this.onPage(e)}\n                paginator={true}\n                rows={this.state.rowsPerPage}\n                totalRecords={this.state.emailList.length}\n                exportFilename=\"Email List\"\n                currentPageReportTemplate={this.state.str}\n                paginatorTemplate=\"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown\"\n                rowsPerPageOptions={this.state.rowsPerPageOptions}\n                globalFilter={this.state.globalFilter}\n                emptyMessage=\"No records found\"\n                responsive={true}\n                resizableColumns={true}\n                columnResizeMode=\"fit\"\n                scrollable={true}\n                scrollHeight=\"340px\">\n                {columns}\n              </DataTable>\n            </ul>\n          </main>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Sent;\n"]},"metadata":{},"sourceType":"module"}