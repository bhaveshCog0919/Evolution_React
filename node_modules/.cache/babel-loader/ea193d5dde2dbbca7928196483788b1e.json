{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Switch,Route}from'react-router-dom';import'./App.scss';import IdleTimer from'react-idle-timer';import{IdleTimeOutModal}from'./modal/IdleModal';import Cookies from'js-cookie';import{UnauthenticatedRoute,AuthenticatedRoute}from'./utils/authenticate';import api from'../src/utils/apiClient';var ResetPassword=React.lazy(function(){return import('./views/Pages/ResetPassword/ResetPassword');});var Register=React.lazy(function(){return import('./views/Pages/Register/Register');});var ForgotPassword=React.lazy(function(){return import('./views/Pages/ForgotPassword/ForgotPassword');});var DefaultLayout=React.lazy(function(){return import('./containers/DefaultLayout');});var GetQuote=React.lazy(function(){return import('./views/Pages/GetQuote/GetQuote');});var Layout=/*#__PURE__*/function(_React$Component){_inherits(Layout,_React$Component);var _super=_createSuper(Layout);function Layout(props){var _this;_classCallCheck(this,Layout);_this=_super.call(this,props);_this.state={timeout:1000*3600*1*8,//(60*60*8 secound) for 8 hour for showing alert\nshowModal:false,userLoggedIn:false,isTimedOut:false,sessiondisable:false};_this.idleTimer=null;_this.onAction=_this._onAction.bind(_assertThisInitialized(_this));_this.onActive=_this._onActive.bind(_assertThisInitialized(_this));_this.onIdle=_this._onIdle.bind(_assertThisInitialized(_this));_this.handleClose=_this.handleClose.bind(_assertThisInitialized(_this));_this.handleLogout=_this.handleLogout.bind(_assertThisInitialized(_this));_this.releaseLock=_this.releaseLock.bind(_assertThisInitialized(_this));return _this;}_createClass(Layout,[{key:\"_onAction\",value:function _onAction(e){// console.log('user did something', e)\nthis.setState({isTimedOut:false});}},{key:\"_onActive\",value:function _onActive(e){// console.log('user is active', e)\nthis.setState({isTimedOut:false});}},{key:\"_onIdle\",value:function _onIdle(e){var _this2=this;// console.log('user is idle', e)\nvar isTimedOut=this.state.isTimedOut;if(isTimedOut){localStorage.clear();this.props.history.push('/login');}else{this.setState({showModal:true});this.idleTimer.reset();this.setState({isTimedOut:true});this.setState({sessiondisable:true});setTimeout(function(){if(_this2.state.sessiondisable){localStorage.clear();_this2.props.history.push('/login');}},900000);//15 min alert logout\n}}},{key:\"handleClose\",value:function handleClose(){this.setState({sessiondisable:false});this.setState({showModal:false});}},{key:\"handleLogout\",value:function handleLogout(){this.setState({showModal:false});this.releaseLock();localStorage.clear();this.props.history.push('/login');}},{key:\"releaseLock\",value:function(){var _releaseLock=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data={'PolicyId':'','ReleaseAll':1};_context.next=3;return api.post('api/releaseLock',data).then(function(res){if(res.success){console.log(\"sucess......\");}else{console.log(\"SomeThing went wrong.\");}}).catch(function(err){console.log(\"setLock err\",err);});case 3:case\"end\":return _context.stop();}}},_callee);}));function releaseLock(){return _releaseLock.apply(this,arguments);}return releaseLock;}()},{key:\"render\",value:function render(){var _this3=this;var match=this.props.match;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(IdleTimer,{ref:function ref(_ref){_this3.idleTimer=_ref;},element:document,onActive:this.onActive,onIdle:this.onIdle,onAction:this.onAction,debounce:250,timeout:this.state.timeout}),/*#__PURE__*/React.createElement(\"script\",{src:\"http://fb.me/react-js-fiddle-integration.js\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(UnauthenticatedRoute,{exact:true,path:\"/resetpassword/:token?\",name:\"Reset Password\",component:ResetPassword}),/*#__PURE__*/React.createElement(UnauthenticatedRoute,{exact:true,path:\"/register\",name:\"Register\",component:Register}),/*#__PURE__*/React.createElement(UnauthenticatedRoute,{exact:true,path:\"/forgotpassword\",name:\"Forgot Password\",component:ForgotPassword}),/*#__PURE__*/React.createElement(UnauthenticatedRoute,{exact:true,path:\"/getQuote/:country\",name:\"Get Quote\",component:GetQuote}),/*#__PURE__*/React.createElement(AuthenticatedRoute,{path:\"/\",name:\"Home\",component:DefaultLayout})),/*#__PURE__*/React.createElement(IdleTimeOutModal,{showModal:this.state.showModal,handleClose:this.handleClose,handleLogout:this.handleLogout})));}}]);return Layout;}(React.Component);export default Layout;","map":{"version":3,"sources":["/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/src/Layout.js"],"names":["React","Switch","Route","IdleTimer","IdleTimeOutModal","Cookies","UnauthenticatedRoute","AuthenticatedRoute","api","ResetPassword","lazy","Register","ForgotPassword","DefaultLayout","GetQuote","Layout","props","state","timeout","showModal","userLoggedIn","isTimedOut","sessiondisable","idleTimer","onAction","_onAction","bind","onActive","_onActive","onIdle","_onIdle","handleClose","handleLogout","releaseLock","e","setState","localStorage","clear","history","push","reset","setTimeout","data","post","then","res","success","console","log","catch","err","match","ref","document","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Switch, Route } from 'react-router-dom'\r\nimport './App.scss';\r\nimport IdleTimer from 'react-idle-timer';\r\nimport { IdleTimeOutModal } from './modal/IdleModal'\r\nimport Cookies from 'js-cookie';\r\nimport {UnauthenticatedRoute, AuthenticatedRoute} from './utils/authenticate'\r\nimport PropTypes from 'prop-types';\r\nimport api from '../src/utils/apiClient';\r\n\r\nconst ResetPassword = React.lazy(() => import('./views/Pages/ResetPassword/ResetPassword'));\r\nconst Register = React.lazy(() => import('./views/Pages/Register/Register'));\r\nconst ForgotPassword = React.lazy(() => import('./views/Pages/ForgotPassword/ForgotPassword'));\r\nconst DefaultLayout = React.lazy(() => import('./containers/DefaultLayout'));\r\nconst GetQuote = React.lazy(() => import('./views/Pages/GetQuote/GetQuote'));\r\n\r\nclass Layout extends React.Component {\r\n\r\n    constructor(props){\r\n        super(props)\r\n\r\n        this.state = {\r\n            timeout:1000 * 3600 * 1 * 8, //(60*60*8 secound) for 8 hour for showing alert\r\n            showModal: false,\r\n            userLoggedIn: false,\r\n            isTimedOut: false,\r\n            sessiondisable:false\r\n        }\r\n\r\n        this.idleTimer = null\r\n        this.onAction = this._onAction.bind(this)\r\n        this.onActive = this._onActive.bind(this)\r\n        this.onIdle = this._onIdle.bind(this)\r\n        this.handleClose = this.handleClose.bind(this)\r\n        this.handleLogout = this.handleLogout.bind(this)\r\n        this.releaseLock = this.releaseLock.bind(this)\r\n      }\r\n\r\n    _onAction(e) {\r\n      // console.log('user did something', e)\r\n      this.setState({isTimedOut: false})\r\n    }\r\n   \r\n    _onActive(e) {\r\n      // console.log('user is active', e)\r\n      this.setState({isTimedOut: false})\r\n    }\r\n   \r\n    _onIdle(e) {\r\n      // console.log('user is idle', e)\r\n      const isTimedOut = this.state.isTimedOut\r\n      if (isTimedOut) {\r\n          localStorage.clear()\r\n          this.props.history.push('/login')\r\n      } else {\r\n        this.setState({showModal: true})\r\n        this.idleTimer.reset();\r\n        this.setState({isTimedOut: true})\r\n        this.setState({sessiondisable: true})\r\n        setTimeout(() => {\r\n          if(this.state.sessiondisable){\r\n            localStorage.clear()\r\n            this.props.history.push('/login')\r\n          }\r\n        }, 900000);//15 min alert logout\r\n      }\r\n      \r\n    }\r\n\r\n    handleClose() {\r\n      this.setState({sessiondisable: false})\r\n      this.setState({showModal: false})\r\n    }\r\n\r\n    handleLogout() {\r\n      this.setState({showModal: false})\r\n      this.releaseLock();\r\n      localStorage.clear()\r\n      this.props.history.push('/login')\r\n    }\r\n\r\n    async releaseLock(){\r\n      let data = {\r\n        'PolicyId' : '',\r\n        'ReleaseAll' : 1\r\n    };\r\n    \r\n    await api.post('api/releaseLock', data).then(res => {\r\n        if (res.success) {\r\n            console.log(\"sucess......\")\r\n        } else {\r\n           console.log(\"SomeThing went wrong.\");\r\n        }\r\n    }).catch(err => {\r\n        console.log(\"setLock err\", err);\r\n    });\r\n    }\r\n\r\n    render(){\r\n      const { match } = this.props\r\n      return(\r\n        <>\r\n          <IdleTimer\r\n            ref={ref => { this.idleTimer = ref }}\r\n            element={document}\r\n            onActive={this.onActive}\r\n            onIdle={this.onIdle}\r\n            onAction={this.onAction}\r\n            debounce={250}\r\n            timeout={this.state.timeout} />\r\n            <script src=\"http://fb.me/react-js-fiddle-integration.js\"></script>\r\n            <div className=\"\">\r\n                  <Switch>\r\n                  <UnauthenticatedRoute exact path=\"/resetpassword/:token?\" name=\"Reset Password\" component={ResetPassword} />\r\n                  <UnauthenticatedRoute exact path=\"/register\" name=\"Register\" component={Register} />\r\n                  <UnauthenticatedRoute exact path=\"/forgotpassword\" name=\"Forgot Password\" component={ForgotPassword} />\r\n                  <UnauthenticatedRoute exact path=\"/getQuote/:country\" name=\"Get Quote\" component={GetQuote} />\r\n                  <AuthenticatedRoute path=\"/\" name=\"Home\" component={DefaultLayout} />\r\n                  </Switch>\r\n                \r\n                <IdleTimeOutModal \r\n                    showModal={this.state.showModal} \r\n                    handleClose={this.handleClose}\r\n                    handleLogout={this.handleLogout}\r\n                />\r\n            </div>\r\n        </>\r\n      )\r\n   }\r\n\r\n }\r\n\r\n Layout.propTypes = {\r\n     match: PropTypes.any.isRequired,\r\n     history: PropTypes.func.isRequired\r\n }\r\n\r\nexport default Layout"]},"metadata":{},"sourceType":"module"}