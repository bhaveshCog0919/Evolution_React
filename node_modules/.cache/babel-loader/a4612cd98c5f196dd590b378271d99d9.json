{"ast":null,"code":"import _defineProperty from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Modal,Collapse,Button as BTN,ModalHeader,Card,CardHeader,CardBody,Col,Row,Input,Form}from'reactstrap';import{Button}from'primereact/button';import api from'../../utils/apiClient';import{withTranslation}from'react-i18next';import{DataTable}from'primereact/datatable';import{Column}from'primereact/column';import{MultiSelect}from'primereact/multiselect';import{InputText}from'primereact/inputtext';import'react-toastify/dist/ReactToastify.css';import{CommonConfig}from'../../utils/constants';import DatePicker from'react-date-picker';import moment from'moment';import APIConstant from'../../utils/constants';import Select from'react-select';import'react-select/dist/react-select.min.css';import{off}from'codemirror';import{toast}from'react-toastify';import CKEditor from'ckeditor4-react';var DraftPage=/*#__PURE__*/function(_Component){_inherits(DraftPage,_Component);var _super=_createSuper(DraftPage);function DraftPage(props){var _this;_classCallCheck(this,DraftPage);_this=_super.call(this,props);_this.handleDetailsChange=function(evt){var data=evt.editor.getData();if(CommonConfig.isEmpty(data)){_this.setState({templateNote:''});}else{_this.setState({templateNote:data});}};_this.handleChange=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.state={custom:true,messagetype:'SMS',policyCount:0,templateList:[],templateId:'',editMessageField:false,DynamicTemplateList:[],DynamicTemplateId:'',addRecipientSmsEmailData:[],templateNote:'',updateTemplate:false,batchMessageHeaderId:localStorage.getItem('batchMessageHeaderId'),loginId:CommonConfig.loggedInUserId()};_this.onRadioBtnClick=_this.onRadioBtnClick.bind(_assertThisInitialized(_this));return _this;}_createClass(DraftPage,[{key:\"componentDidMount\",value:function componentDidMount(){this.getSmsEmailTemplate();this.getSmsEmailCount();}},{key:\"SentData\",value:function SentData(){var _data;var data=(_data={templateId:this.state.templateId,custom:this.state.custom,messagetype:this.state.messagetype,policyCount:this.state.policyCount,getSmsEmailCount:this.state.getSmsEmailCount,templateList:this.state.templateList},_defineProperty(_data,\"templateId\",this.state.templateId),_defineProperty(_data,\"editMessageField\",this.state.editMessageField),_defineProperty(_data,\"DynamicTemplateList\",this.state.templateId),_defineProperty(_data,\"DynamicTemplateId\",this.state.DynamicTemplateId),_defineProperty(_data,\"templateNote\",this.state.templateNote),_defineProperty(_data,\"updateTemplate\",this.state.updateTemplate),_defineProperty(_data,\"loginId\",this.state.loginId),_defineProperty(_data,\"batchMessageHeaderId\",localStorage.getItem('batchMessageHeaderId')),_data);api.post('api/sendSMSEMAIL',data).then(function(res){if(res.success){}});}},{key:\"getDinamicField\",value:function getDinamicField(){var _this2=this;var data={messagetype:this.state.messagetype,templateId:this.state.templateId,loginId:this.state.loginId};api.post('api/getDinamicField',data).then(function(res){debugger;if(res.success){_this2.state.DynamicTemplateList=[];res.data.forEach(function(element){var data={value:element.TamplateName,label:element.TamplateName};_this2.state.DynamicTemplateList.push(data);});}});}},{key:\"getSmsEmailTemplate\",value:function getSmsEmailTemplate(){var _this3=this;var data={messagetype:this.state.messagetype,// templateId: this.state.templateId,\nloginId:this.state.loginId};api.post('api/getSmsEmailTemplate',data).then(function(res){debugger;if(res.success){_this3.state.templateList=[];_this3.setState({templateListdata:res.data});res.data.forEach(function(element){var data={value:element.MessageTemplateId,label:element.TamplateName};_this3.state.templateList.push(data);});}});}},{key:\"getSmsEmailCount\",value:function getSmsEmailCount(){var _this4=this;var data={batchMessageHeaderId:localStorage.getItem('batchMessageHeaderId'),loginId:this.state.loginId};api.post('api/getSmsEmailCount',data).then(function(res){debugger;if(res.success){_this4.setState({getSmsEmailCount:res.data,policyCount:res.data.length});}});}},{key:\"onRadioBtnClick\",value:function onRadioBtnClick(radioType,radioSelected){this.setState(_defineProperty({},radioType,radioSelected));this.getSmsEmailTemplate();this.getDinamicField();}},{key:\"componentWillUpdate\",value:function componentWillUpdate(nextProps){}},{key:\"editMessageField\",value:function editMessageField(){this.setState({editMessageField:!this.state.editMessageField});this.getDinamicField();}},{key:\"selectType\",value:function selectType(value,type){var _this5=this;if(value===''||value===undefined||value===null){this.setState(_defineProperty({},type,''));}else{this.setState(_defineProperty({},type,value.value));debugger;if(type=='templateId'){this.state.templateListdata.forEach(function(element){// this.setState({ templateNote: '' });\nif(element.MessageTemplateId==value.value){_this5.setState({templateNote:element.TemplateMessage});}});}else if(type=='DynamicTemplateId'){var note=this.state.templateNote;note=note+value.value;this.setState({templateNote:note});}}}},{key:\"render\",value:function render(){var _this6=this;var t=this.props.t;var header=null;return/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\",id:\"accordion\"},/*#__PURE__*/React.createElement(Card,{className:\"mb-0\"},/*#__PURE__*/React.createElement(CardHeader,{id:\"headingOne\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"m-0 p-0\"},\"Draft message\")),/*#__PURE__*/React.createElement(Collapse,{isOpen:this.state.custom,\"data-parent\":\"#accordion\",id:\"collapseOne\",\"aria-labelledby\":\"headingOne\"},/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(\"div\",{className:\"filter-data\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},\"You have Selected: \",this.state.policyCount)))),/*#__PURE__*/React.createElement(Row,{style:{marginBottom:'25px'}},/*#__PURE__*/React.createElement(Col,{md:\"2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},\"Message Type\"))),/*#__PURE__*/React.createElement(Col,{md:\"1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},/*#__PURE__*/React.createElement(Input,{type:\"radio\",name:\"messagetype\",checked:this.state.messagetype==='SMS'?true:false,value:this.state.messagetype,onClick:function onClick(){return _this6.onRadioBtnClick('messagetype','SMS');}}),\"SMS\"))),/*#__PURE__*/React.createElement(Col,{md:\"1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},/*#__PURE__*/React.createElement(Input,{type:\"radio\",name:\"messagetype\",checked:this.state.messagetype==='EMAIL'?true:false,value:this.state.messagetype,onClick:function onClick(){return _this6.onRadioBtnClick('messagetype','EMAIL');}}),\"EMAIL\")))),/*#__PURE__*/React.createElement(Row,{style:{marginBottom:'25px'}},/*#__PURE__*/React.createElement(Col,{md:\"2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},\"Select SMS/Email Template\"))),/*#__PURE__*/React.createElement(Col,{md:\"2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(Select,{name:\"templateId\",id:\"templateId\",options:this.state.templateList,value:this.state.templateId,onChange:function onChange(data){return _this6.selectType(data,'templateId');}})))),/*#__PURE__*/React.createElement(Row,{style:{marginBottom:'25px'}},/*#__PURE__*/React.createElement(Col,{md:\"1\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(BTN,{color:\"success\",title:\"Edit\",onClick:function onClick(){return _this6.editMessageField();}},\"Edit\"))),/*#__PURE__*/React.createElement(Col,{md:\"2\"},this.state.editMessageField?/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},\"Pick Dynamic Field\")):null),/*#__PURE__*/React.createElement(Col,{md:\"2\"},this.state.editMessageField?/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(Select,{name:\"DynamicTemplateId\",id:\"DynamicTemplateId\",options:this.state.DynamicTemplateList,value:this.state.DynamicTemplateId,onChange:function onChange(data){return _this6.selectType(data,'DynamicTemplateId');}})):null)),/*#__PURE__*/React.createElement(Row,{style:{marginBottom:'25px'}},/*#__PURE__*/React.createElement(Col,{md:\"1\"},this.state.messagetype=='SMS'?/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},\"Message\")):/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},\"Email\"))),/*#__PURE__*/React.createElement(Col,{md:\"11\"},this.state.messagetype=='SMS'?/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},/*#__PURE__*/React.createElement(Input,{name:\"templateNote\",type:\"textarea\",id:\"templateNote\",className:\"\",onChange:function onChange(e){return _this6.handleChange(e);},value:this.state.templateNote}))):/*#__PURE__*/React.createElement(CKEditor,{name:\"templateNote\",id:\"templateNote\",data:this.state.templateNote,onChange:this.handleDetailsChange}))),/*#__PURE__*/React.createElement(Row,{style:{marginBottom:'25px'}},/*#__PURE__*/React.createElement(Col,{md:\"2\",style:{marginLeft:'25px'}},/*#__PURE__*/React.createElement(\"div\",{className:\"input-box\"},/*#__PURE__*/React.createElement(\"label\",{style:{marginTop:'10px'}},/*#__PURE__*/React.createElement(Input,{type:\"radio\",name:\"updateTemplate\",checked:this.state.updateTemplate==='yes'?true:false,value:this.state.updateTemplate,onClick:function onClick(){return _this6.onRadioBtnClick('updateTemplate','yes');}}),\"Update Template\"))),/*#__PURE__*/React.createElement(Col,{md:\"1\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(BTN,{color:\"success\",title:\"Sent\",onClick:function onClick(){return _this6.SentData();}},\"Send\")))))))));}}]);return DraftPage;}(Component);export default withTranslation()(DraftPage);","map":{"version":3,"sources":["/Users/bhavik/Downloads/Cognisun/Evolution/Evolution_React/evolution_new/src/views/Reports/DraftPage.js"],"names":["React","Component","Modal","Collapse","Button","BTN","ModalHeader","Card","CardHeader","CardBody","Col","Row","Input","Form","api","withTranslation","DataTable","Column","MultiSelect","InputText","CommonConfig","DatePicker","moment","APIConstant","Select","off","toast","CKEditor","DraftPage","props","handleDetailsChange","evt","data","editor","getData","isEmpty","setState","templateNote","handleChange","e","target","name","value","state","custom","messagetype","policyCount","templateList","templateId","editMessageField","DynamicTemplateList","DynamicTemplateId","addRecipientSmsEmailData","updateTemplate","batchMessageHeaderId","localStorage","getItem","loginId","loggedInUserId","onRadioBtnClick","bind","getSmsEmailTemplate","getSmsEmailCount","post","then","res","success","forEach","element","TamplateName","label","push","templateListdata","MessageTemplateId","length","radioType","radioSelected","getDinamicField","nextProps","type","undefined","TemplateMessage","note","t","header","marginTop","marginBottom","selectType","marginLeft","SentData"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Modal, Collapse, Button as BTN, ModalHeader, Card, CardHeader, CardBody, Col, Row, Input, Form } from 'reactstrap';\r\nimport { Button } from 'primereact/button';\r\nimport api from '../../utils/apiClient';\r\nimport { withTranslation } from 'react-i18next';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { MultiSelect } from 'primereact/multiselect';\r\nimport { InputText } from 'primereact/inputtext';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport { CommonConfig } from '../../utils/constants';\r\nimport DatePicker from 'react-date-picker';\r\nimport moment from 'moment';\r\nimport APIConstant from '../../utils/constants';\r\nimport Select from 'react-select';\r\nimport 'react-select/dist/react-select.min.css';\r\nimport { off } from 'codemirror';\r\nimport { toast } from 'react-toastify';\r\nimport CKEditor from 'ckeditor4-react';\r\n\r\n\r\nclass DraftPage extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            custom: true,\r\n            messagetype: 'SMS',\r\n\r\n            policyCount: 0,\r\n\r\n            templateList: [],\r\n            templateId: '',\r\n\r\n            editMessageField: false,\r\n\r\n            DynamicTemplateList: [],\r\n            DynamicTemplateId: '',\r\n            addRecipientSmsEmailData: [],\r\n            templateNote: '',\r\n\r\n            updateTemplate: false,\r\n            batchMessageHeaderId: localStorage.getItem('batchMessageHeaderId'),\r\n            loginId: CommonConfig.loggedInUserId()\r\n\r\n        };\r\n        this.onRadioBtnClick = this.onRadioBtnClick.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        this.getSmsEmailTemplate();\r\n        this.getSmsEmailCount();\r\n    }\r\n\r\n    SentData() {\r\n        let data = {\r\n            templateId: this.state.templateId,\r\n            custom: this.state.custom,\r\n            messagetype: this.state.messagetype,\r\n\r\n            policyCount: this.state.policyCount,\r\n            getSmsEmailCount: this.state.getSmsEmailCount,\r\n            templateList: this.state.templateList,\r\n            templateId: this.state.templateId,\r\n\r\n            editMessageField: this.state.editMessageField,\r\n\r\n            DynamicTemplateList: this.state.templateId,\r\n            DynamicTemplateId: this.state.DynamicTemplateId,\r\n\r\n            templateNote: this.state.templateNote,\r\n\r\n            updateTemplate: this.state.updateTemplate,\r\n\r\n            loginId: this.state.loginId,\r\n            batchMessageHeaderId: localStorage.getItem('batchMessageHeaderId'),\r\n        };\r\n        api.post('api/sendSMSEMAIL', data).then(res => {\r\n            if (res.success) {\r\n            }\r\n        });\r\n    }\r\n\r\n    getDinamicField() {\r\n        let data = {\r\n            messagetype: this.state.messagetype,\r\n            templateId: this.state.templateId,\r\n            loginId: this.state.loginId,\r\n        };\r\n        api.post('api/getDinamicField', data).then(res => {\r\n            debugger;\r\n            if (res.success) {\r\n                this.state.DynamicTemplateList = [];\r\n                res.data.forEach(element => {\r\n                    var data = {\r\n                        value: element.TamplateName,\r\n                        label: element.TamplateName\r\n                    }\r\n                    this.state.DynamicTemplateList.push(data);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    getSmsEmailTemplate() {\r\n        let data = {\r\n            messagetype: this.state.messagetype,\r\n            // templateId: this.state.templateId,\r\n            loginId: this.state.loginId,\r\n        };\r\n        api.post('api/getSmsEmailTemplate', data).then(res => {\r\n            debugger;\r\n            if (res.success) {\r\n                this.state.templateList = [];\r\n                this.setState({ templateListdata: res.data });\r\n                res.data.forEach(element => {\r\n                    var data = {\r\n                        value: element.MessageTemplateId,\r\n                        label: element.TamplateName\r\n                    }\r\n                    this.state.templateList.push(data);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    getSmsEmailCount() {\r\n        let data = {\r\n            batchMessageHeaderId: localStorage.getItem('batchMessageHeaderId'),\r\n            loginId: this.state.loginId,\r\n        };\r\n        api.post('api/getSmsEmailCount', data).then(res => {\r\n            debugger;\r\n            if (res.success) {\r\n                this.setState({\r\n                    getSmsEmailCount: res.data,\r\n                    policyCount: res.data.length\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    onRadioBtnClick(radioType, radioSelected) {\r\n        this.setState({ [radioType]: radioSelected });\r\n        this.getSmsEmailTemplate();\r\n        this.getDinamicField();\r\n    }\r\n\r\n    componentWillUpdate(nextProps) {\r\n\r\n    }\r\n\r\n    editMessageField() {\r\n        this.setState({ editMessageField: !this.state.editMessageField });\r\n        this.getDinamicField();\r\n    }\r\n    selectType(value, type) {\r\n        if (value === '' || value === undefined || value === null) {\r\n            this.setState({ [type]: '' });\r\n        } else {\r\n            this.setState({ [type]: value.value });\r\n            debugger;\r\n            if (type == 'templateId') {\r\n                this.state.templateListdata.forEach(element => {\r\n                    // this.setState({ templateNote: '' });\r\n                    if (element.MessageTemplateId == value.value) {\r\n\r\n                        this.setState({ templateNote: element.TemplateMessage });\r\n                    }\r\n                });\r\n            }\r\n            else if (type == 'DynamicTemplateId') {\r\n                var note = this.state.templateNote;\r\n                note = note + value.value;\r\n                this.setState({ templateNote: note });\r\n            }\r\n        }\r\n    }\r\n\r\n    handleDetailsChange = (evt) => {\r\n        const data = evt.editor.getData();\r\n        if (CommonConfig.isEmpty(data)) {\r\n            this.setState({ templateNote: '' });\r\n        } else {\r\n            this.setState({ templateNote: data });\r\n        }\r\n    }\r\n\r\n    handleChange = (e) => {\r\n        this.setState({ [e.target.name]: e.target.value });\r\n    }\r\n    render() {\r\n        const { t } = this.props;\r\n        var header = null;\r\n\r\n        return (\r\n            <div className=\"input-box\" id=\"accordion\">\r\n                <Card className=\"mb-0\">\r\n                    <CardHeader id=\"headingOne\">\r\n                        <h5 className=\"m-0 p-0\">Draft message</h5>\r\n                    </CardHeader>\r\n                    <Collapse isOpen={this.state.custom} data-parent=\"#accordion\" id=\"collapseOne\" aria-labelledby=\"headingOne\">\r\n                        <CardBody>\r\n                            <div className=\"filter-data\">\r\n                                <Row>\r\n                                    <Col md='2'>\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>You have Selected: {this.state.policyCount}</label>\r\n                                        </div>\r\n                                    </Col></Row>\r\n                                <Row style={{ marginBottom: '25px' }}>\r\n                                    <Col md='2'>\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>Message Type</label>\r\n                                        </div>\r\n                                    </Col>\r\n                                    <Col md='1'>\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>\r\n                                                <Input type=\"radio\" name=\"messagetype\" checked={(this.state.messagetype === 'SMS') ? true : false} value={this.state.messagetype} onClick={() => this.onRadioBtnClick('messagetype', 'SMS')} />SMS</label>\r\n                                        </div>\r\n                                    </Col>\r\n                                    <Col md='1'>\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>\r\n                                                <Input type=\"radio\" name=\"messagetype\" checked={(this.state.messagetype === 'EMAIL') ? true : false}\r\n                                                    value={this.state.messagetype} onClick={() => this.onRadioBtnClick('messagetype', 'EMAIL')} />EMAIL</label>\r\n                                        </div>\r\n                                    </Col>\r\n                                </Row>\r\n                                <Row style={{ marginBottom: '25px' }}>\r\n                                    <Col md='2'>\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>Select SMS/Email Template</label>\r\n                                        </div>\r\n                                    </Col>\r\n                                    <Col md='2'>\r\n                                        <div className=\"input-box\">\r\n                                            <Select name=\"templateId\" id=\"templateId\" options={this.state.templateList}\r\n                                                value={this.state.templateId} onChange={(data) => this.selectType(data, 'templateId')}\r\n                                            />\r\n                                        </div>\r\n                                    </Col>\r\n\r\n                                </Row>\r\n                                <Row style={{ marginBottom: '25px' }}>\r\n                                    <Col md='1'>\r\n                                        <div><BTN color=\"success\" title=\"Edit\" onClick={() => this.editMessageField()}>Edit</BTN></div></Col>\r\n                                    <Col md='2'>\r\n                                        {(this.state.editMessageField) ? (<div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>Pick Dynamic Field</label>\r\n                                        </div>) : (null)}\r\n\r\n                                    </Col>\r\n                                    <Col md='2'>\r\n                                        {(this.state.editMessageField) ? (<div className=\"input-box\">\r\n                                            <Select name=\"DynamicTemplateId\" id=\"DynamicTemplateId\" options={this.state.DynamicTemplateList}\r\n                                                value={this.state.DynamicTemplateId} onChange={(data) => this.selectType(data, 'DynamicTemplateId')}\r\n                                            />\r\n                                        </div>) : (null)}\r\n                                    </Col>\r\n\r\n                                </Row>\r\n                                <Row style={{ marginBottom: '25px' }}>\r\n                                    <Col md='1'>{(this.state.messagetype == 'SMS') ? (\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>Message</label>\r\n                                        </div>) : (<div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>Email</label>\r\n                                        </div>)}\r\n                                    </Col>\r\n                                    <Col md='11'>\r\n                                        {(this.state.messagetype == 'SMS') ? (\r\n                                            <div className=\"input-box\">\r\n                                                <label style={{ marginTop: '10px' }}>\r\n                                                    <Input name=\"templateNote\" type=\"textarea\" id=\"templateNote\" className=\"\" onChange={e => this.handleChange(e)} value={this.state.templateNote} />\r\n                                                </label>\r\n                                            </div>) : (<CKEditor name=\"templateNote\" id=\"templateNote\" data={this.state.templateNote} onChange={this.handleDetailsChange} />)}\r\n                                    </Col>\r\n                                </Row>\r\n                                <Row style={{ marginBottom: '25px' }}>\r\n                                    <Col md='2' style={{ marginLeft: '25px' }}>\r\n                                        <div className=\"input-box\">\r\n                                            <label style={{ marginTop: '10px' }}>\r\n                                                <Input type=\"radio\" name=\"updateTemplate\" checked={(this.state.updateTemplate === 'yes') ? true : false}\r\n                                                    value={this.state.updateTemplate} onClick={() => this.onRadioBtnClick('updateTemplate', 'yes')} />Update Template</label>\r\n                                        </div>\r\n                                    </Col>\r\n                                    <Col md='1'>\r\n                                        <div>\r\n                                            <BTN color=\"success\" title=\"Sent\" onClick={() => this.SentData()}>Send</BTN>\r\n                                        </div>\r\n                                    </Col>\r\n                                </Row>\r\n                            </div>\r\n                        </CardBody>\r\n                    </Collapse>\r\n                </Card>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\nexport default withTranslation()(DraftPage);"]},"metadata":{},"sourceType":"module"}